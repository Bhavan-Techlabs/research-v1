# ðŸ—ï¸ Architecture Diagram - Research Assistant v2.0

## System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE LAYER                         â”‚
â”‚                            (Streamlit)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  app.py (Entry Point)                                                â”‚
â”‚  â”œâ”€â”€ Authentication                                                  â”‚
â”‚  â””â”€â”€ Navigation                                                      â”‚
â”‚                                                                       â”‚
â”‚  pages/                                                              â”‚
â”‚  â”œâ”€â”€ 00_home.py            - Dashboard & Quick Access               â”‚
â”‚  â”œâ”€â”€ 01_research_assistant.py - Multi-source Paper Search           â”‚
â”‚  â”œâ”€â”€ 02_paper_analyzer.py     - PDF Analysis                        â”‚
â”‚  â”œâ”€â”€ 03_rag_chat.py           - Document Q&A                        â”‚
â”‚  â”œâ”€â”€ 04_prompt_manager.py     - Prompt CRUD                         â”‚
â”‚  â””â”€â”€ 05_settings.py           - Configuration                       â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ uses
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CORE BUSINESS LOGIC LAYER                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  src/core/                                                           â”‚
â”‚  â”œâ”€â”€ research_search.py                                             â”‚
â”‚  â”‚   â””â”€â”€ ResearchSearcher                                           â”‚
â”‚  â”‚       â”œâ”€â”€ search_all_sources()                                   â”‚
â”‚  â”‚       â”œâ”€â”€ search_arxiv()                                         â”‚
â”‚  â”‚       â”œâ”€â”€ search_semantic_scholar()                              â”‚
â”‚  â”‚       â””â”€â”€ search_google/duckduckgo()                             â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€â”€ paper_analyzer.py                                              â”‚
â”‚  â”‚   â””â”€â”€ PaperAnalyzer                                              â”‚
â”‚  â”‚       â”œâ”€â”€ analyze_pdf()                                          â”‚
â”‚  â”‚       â”œâ”€â”€ analyze_multiple_pdfs()                                â”‚
â”‚  â”‚       â””â”€â”€ _build_analysis_prompt()                               â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â””â”€â”€ rag_system.py                                                  â”‚
â”‚      â””â”€â”€ RAGSystem                                                  â”‚
â”‚          â”œâ”€â”€ create_retriever()                                     â”‚
â”‚          â””â”€â”€ query()                                                â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ depends on
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICES LAYER (API Integrations)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  src/services/                                                       â”‚
â”‚  â”œâ”€â”€ openai_service.py                                              â”‚
â”‚  â”‚   â””â”€â”€ OpenAIService                                              â”‚
â”‚  â”‚       â”œâ”€â”€ chat_completion()                                      â”‚
â”‚  â”‚       â”œâ”€â”€ simple_query()                                         â”‚
â”‚  â”‚       â”œâ”€â”€ structured_query()                                     â”‚
â”‚  â”‚       â””â”€â”€ analyze_paper()                                        â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€â”€ arxiv_service.py                                               â”‚
â”‚  â”‚   â””â”€â”€ ArxivService                                               â”‚
â”‚  â”‚       â”œâ”€â”€ search_with_agent()                                    â”‚
â”‚  â”‚       â”œâ”€â”€ load_documents_from_query()                            â”‚
â”‚  â”‚       â””â”€â”€ load_document_by_id()                                  â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€â”€ semantic_scholar_service.py                                    â”‚
â”‚  â”‚   â””â”€â”€ SemanticScholarService                                     â”‚
â”‚  â”‚       â””â”€â”€ search()                                               â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â””â”€â”€ search_service.py                                              â”‚
â”‚      â””â”€â”€ SearchService                                              â”‚
â”‚          â”œâ”€â”€ google_search()                                        â”‚
â”‚          â””â”€â”€ duckduckgo_search()                                    â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ uses
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UTILITIES LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  src/utils/                                                          â”‚
â”‚  â”œâ”€â”€ document_utils.py                                              â”‚
â”‚  â”‚   â””â”€â”€ DocumentProcessor                                          â”‚
â”‚  â”‚       â”œâ”€â”€ extract_text_from_pdf()                                â”‚
â”‚  â”‚       â”œâ”€â”€ extract_text_from_html()                               â”‚
â”‚  â”‚       â”œâ”€â”€ extract_text_from_url()                                â”‚
â”‚  â”‚       â”œâ”€â”€ load_documents_from_path()                             â”‚
â”‚  â”‚       â””â”€â”€ save_uploaded_file()                                   â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€â”€ token_utils.py                                                 â”‚
â”‚  â”‚   â””â”€â”€ TokenManager                                               â”‚
â”‚  â”‚       â”œâ”€â”€ count_tokens()                                         â”‚
â”‚  â”‚       â”œâ”€â”€ truncate_text()                                        â”‚
â”‚  â”‚       â””â”€â”€ optimize_prompt()                                      â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€â”€ session_manager.py                                             â”‚
â”‚  â”‚   â””â”€â”€ SessionStateManager                                        â”‚
â”‚  â”‚       â”œâ”€â”€ initialize()                                           â”‚
â”‚  â”‚       â”œâ”€â”€ get() / set() / clear()                                â”‚
â”‚  â”‚       â”œâ”€â”€ add_search_to_history()                                â”‚
â”‚  â”‚       â””â”€â”€ add_message_to_chat()                                  â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â”œâ”€â”€ mongo_utils.py                                                 â”‚
â”‚  â”‚   â””â”€â”€ PromptManager                                              â”‚
â”‚  â”‚       â”œâ”€â”€ add_prompt()                                           â”‚
â”‚  â”‚       â”œâ”€â”€ get_prompt_by_title()                                  â”‚
â”‚  â”‚       â”œâ”€â”€ update_prompt()                                        â”‚
â”‚  â”‚       â””â”€â”€ delete_prompt()                                        â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â””â”€â”€ mongo_manager.py                                               â”‚
â”‚      â””â”€â”€ MongoDBManager (base class)                                â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ uses
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONFIGURATION LAYER                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  config/                                                             â”‚
â”‚  â”œâ”€â”€ settings.py                                                    â”‚
â”‚  â”‚   â””â”€â”€ Settings (class)                                           â”‚
â”‚  â”‚       â”œâ”€â”€ API Keys (OPENAI_API_KEY, etc.)                        â”‚
â”‚  â”‚       â”œâ”€â”€ Model Configuration (DEFAULT_MODEL, etc.)              â”‚
â”‚  â”‚       â”œâ”€â”€ Document Processing (CHUNK_SIZE, etc.)                 â”‚
â”‚  â”‚       â”œâ”€â”€ Search Configuration (MAX_RESULTS, etc.)               â”‚
â”‚  â”‚       â”œâ”€â”€ is_openai_configured()                                 â”‚
â”‚  â”‚       â”œâ”€â”€ is_google_configured()                                 â”‚
â”‚  â”‚       â””â”€â”€ ensure_directories()                                   â”‚
â”‚  â”‚                                                                   â”‚
â”‚  â””â”€â”€ constants.py                                                   â”‚
â”‚      â”œâ”€â”€ ANALYSIS_TYPES                                             â”‚
â”‚      â”œâ”€â”€ OUTPUT_FORMATS                                             â”‚
â”‚      â”œâ”€â”€ SEARCH_SOURCES                                             â”‚
â”‚      â”œâ”€â”€ UI_MESSAGES                                                â”‚
â”‚      â””â”€â”€ EXAMPLE_QUERIES                                            â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                              â–²
                              â”‚
                              â”‚ reads from
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXTERNAL CONFIGURATION                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  .env (Environment Variables)                                        â”‚
â”‚  â”œâ”€â”€ OPENAI_API_KEY                                                 â”‚
â”‚  â”œâ”€â”€ GOOGLE_API_KEY                                                 â”‚
â”‚  â”œâ”€â”€ MONGODB_URI                                                    â”‚
â”‚  â””â”€â”€ DEFAULT_MODEL, CHUNK_SIZE, etc.                                â”‚
â”‚                                                                       â”‚
â”‚  .streamlit/                                                         â”‚
â”‚  â”œâ”€â”€ config.yaml (Authentication)                                   â”‚
â”‚  â””â”€â”€ pages_sections.toml (Navigation)                               â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

### Example: Research Paper Search

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User   â”‚ Enter query, select sources
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 01_research_assistant.py    â”‚ UI handles input
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ResearchSearcher (core)     â”‚ Orchestrates search
â”‚ - search_all_sources()      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                     â”‚                     â”‚                  â”‚
     â–¼                     â–¼                     â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ArxivSrv â”‚      â”‚ SemanticSrv  â”‚    â”‚ SearchSrv    â”‚   â”‚ SearchSrv    â”‚
â”‚ search() â”‚      â”‚ search()     â”‚    â”‚ google_srch()â”‚   â”‚ ddg_search() â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                   â”‚                   â”‚                  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ Aggregate       â”‚
                     â”‚ Results         â”‚
                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ SessionManager   â”‚ Store results
                   â”‚ .set(RESULTS)    â”‚
                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Display Results  â”‚ Show in UI
                   â”‚ in Tabs          â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Module Dependency Graph

```
app.py
 â””â”€> pages/*
      â”œâ”€> src/core/*
      â”‚    â”œâ”€> src/services/*
      â”‚    â”‚    â”œâ”€> OpenAI API
      â”‚    â”‚    â”œâ”€> ArXiv API
      â”‚    â”‚    â”œâ”€> Semantic Scholar API
      â”‚    â”‚    â””â”€> Google/DDG Search
      â”‚    â”œâ”€> src/utils/*
      â”‚    â”‚    â”œâ”€> PDF Processing (PyMuPDF)
      â”‚    â”‚    â”œâ”€> Token Management (tiktoken)
      â”‚    â”‚    â””â”€> Document Loading (LangChain)
      â”‚    â””â”€> config/*
      â”‚         â”œâ”€> settings.py (Environment Vars)
      â”‚         â””â”€> constants.py
      â””â”€> src/utils/session_manager.py
           â””â”€> Streamlit Session State
```

---

## Sequence Diagram: RAG Chat

```
User                  RAG Page           RAGSystem          OpenAI
 â”‚                       â”‚                   â”‚                â”‚
 â”‚  Upload PDF           â”‚                   â”‚                â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                â”‚
 â”‚                       â”‚  create_retriever()â”‚                â”‚
 â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
 â”‚                       â”‚                   â”‚  Embed chunks  â”‚
 â”‚                       â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                       â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
 â”‚  Ask Question         â”‚                   â”‚                â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                â”‚
 â”‚                       â”‚  query(question)  â”‚                â”‚
 â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
 â”‚                       â”‚                   â”‚  Retrieve docs â”‚
 â”‚                       â”‚                   â”‚  + Generate    â”‚
 â”‚                       â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                       â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚                â”‚
 â”‚  Display Answer       â”‚                   â”‚                â”‚
```

---

## Component Interaction Matrix

| Component | Uses | Used By |
|-----------|------|---------|
| Pages | Core, Utils, Config | app.py |
| Core (ResearchSearcher) | Services, Utils | Pages |
| Core (PaperAnalyzer) | Services, Utils | Pages |
| Core (RAGSystem) | Services, Utils | Pages |
| Services (OpenAI) | OpenAI API, Config | Core, Pages |
| Services (ArXiv) | ArXiv API, LangChain | Core |
| Services (Search) | Google/DDG APIs | Core |
| Utils (DocumentProcessor) | PyMuPDF, BeautifulSoup | Core, Pages |
| Utils (TokenManager) | tiktoken, Config | Core, Services |
| Utils (SessionManager) | Streamlit State | Pages |
| Config (Settings) | Environment Vars | All Layers |
| Config (Constants) | - | All Layers |

---

## File Size Comparison

### Before (v1.0)
```
research_app.py     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 402 lines
paper_analyzer.py   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 251 lines
research_assist.py  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 236 lines
rag_chat.py         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 207 lines
```

### After (v2.0) - Largest Files
```
research_assistant.py  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 250 lines (UI)
home.py               â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 180 lines (UI)
paper_analyzer.py     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 140 lines (Core Logic)
research_search.py    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 120 lines (Core Logic)
document_utils.py     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 115 lines (Utils)
rag_system.py         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100 lines (Core Logic)
openai_service.py     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 95 lines (Service)
arxiv_service.py      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 90 lines (Service)
```

**Result**: Maximum file size reduced from 402 to 250 lines (38% reduction)

---

## Design Patterns Used

1. **Service Layer Pattern**: External API interactions isolated
2. **Repository Pattern**: MongoDB manager for data access
3. **Facade Pattern**: Core modules provide simple interfaces
4. **Singleton Pattern**: Settings and SessionManager (via class methods)
5. **Factory Pattern**: Service creation with configuration
6. **Strategy Pattern**: Different analysis types, search sources
7. **Dependency Injection**: Services accept configuration

---

**This architecture provides:**
- âœ… Separation of concerns
- âœ… Testability
- âœ… Maintainability
- âœ… Scalability
- âœ… Clear dependencies
- âœ… Easy to understand
- âœ… Production-ready
